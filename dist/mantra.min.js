'use strict';var g = !0, n = null, p = !1;
(function(k) {
  var c = k.Mantra = {e:q || k.Modernizr};
  c.q = $(k.document);
  var q = c.e;
  q.addTest("pointerevents", function() {
    return k.navigator.pointerEnabled || k.navigator.msPointerEnabled || p
  });
  var r = /mobile|tablet|ip(ad|hone|od)|android/i;
  q.addTest("mouseevents", function() {
    return!(q.P && k.navigator.userAgent.match(r))
  });
  c.C = [, , "TOUCH", "PEN", "MOUSE"];
  c.D = "mouse";
  c.F = "touch";
  c.O = "pen";
  c.c = "start";
  c.b = "move";
  c.a = "end";
  (function() {
    var a = {};
    c.e.touch ? c.e.mouseevents ? (a[c.c] = "touchstart mousedown", a[c.b] = "touchmove mousemove", a[c.a] = "touchend touchcancel mouseup") : (a[c.c] = "touchstart", a[c.b] = "touchmove", a[c.a] = "touchend touchcancel") : c.e.pointerevents ? (a[c.c] = "pointerdown MSPointerDown", a[c.b] = "pointermove MSPointerMove", a[c.a] = "pointerup pointercancel MSPointerUp MSPointerCancel") : (a[c.c] = "mousedown", a[c.b] = "mousemove", a[c.a] = "mouseup");
    c.d = a
  })();
  c.define = function(a, b) {
    function d(a, b) {
      return"function" === typeof a && -1 != a.toString().indexOf("__super") ? function() {
        var c = this.j;
        this.j = b;
        var d = a.apply(this, arguments);
        this.j = c;
        return d
      } : a
    }
    b || (b = {});
    var e = c, f = b.hasOwnProperty("constructor") && "function" == typeof b.constructor ? b.constructor : p, l = "string" == typeof b.extend ? c.resolve(b.extend) : b.extend;
    if(f) {
      var h, s = f, f = function() {
        d(s, l ? l : void 0).apply(this, arguments)
      };
      l && (h = function() {
      }, l.prototype || (l = l.constructor), h.prototype = l.prototype, f.prototype = new h, f.prototype.constructor = f);
      h = f.prototype;
      for(var m in b) {
        b.hasOwnProperty(m) && ("constructor" != m && "statics" != m) && (h[m] = d(b[m], l ? l.prototype[m] : void 0))
      }
      f.prototype.singleton && !f.prototype.hasOwnProperty("abstract") && (f = new f)
    }
    a = a.split(".");
    "Mantra" == a[0] && a.shift();
    m = 0;
    for(h = a.length;m < h;m++) {
      var k = a[m];
      e[k] || (e[k] = m == h - 1 && f ? f : {});
      e = e[k]
    }
    if(f = f ? b.statics : b) {
      for(var q in f) {
        f.hasOwnProperty(q) && (e[q] = f[q])
      }
    }
    return e
  };
  c.resolve = function(a) {
    var b = c;
    a = a.split(".");
    "Mantra" == a[0] && a.shift();
    for(var d = 0, e = a.length;d < e && !(b = b[a[d]], !b);d++) {
    }
    return b
  };
  c.relayMethod = function(a, b, d) {
    if(d) {
      a[d] = b[d].bind(b)
    }else {
      for(d in b) {
        b.hasOwnProperty(d) && "function" == typeof b[d] && c.relayMethod(a, b, d)
      }
    }
  };
  c.n = "_mantra";
  c.getStore = function(a) {
    var b = c.hasStore(a);
    b || ($(a).data(c.n, {}), b = $(a).data(c.n));
    return b
  };
  c.hasStore = function(a) {
    return $(a).data(c.n)
  };
  c.define("Mantra.GesturesDispatcher", {singleton:g, constructor:function() {
    this.m = this.m.bind(this)
  }, g:{}, l:0, register:function(a) {
    a instanceof c.Gesture || ("string" == typeof a && (a = c.resolve(a)), a = new a);
    this.g[a.name] = {gesture:a, B:0}
  }, on:function(a, b, d) {
    if(this.g[a]) {
      b = $(b);
      var e = c.getStore(b);
      e.listeners || (e.listeners = {});
      (e.listeners[a] || (e.listeners[a] = [])).push(d);
      this.l++;
      this.g[a].B++;
      if(1 == (e.count || (e.count = 1))) {
        b[0].style.msTouchAction = "none", this.r(c.d[c.c], b)
      }
      1 == this.l && this.r(c.d[c.b] + " " + c.d[c.a])
    }
  }, off:function(a, b, d) {
    if(this.g[a]) {
      b = $(b);
      var e = c.getStore(b), f;
      f = e.listeners[a];
      d = f.indexOf(d);
      -1 < d && (e[a] = f.splice(d, 1), this.l--, this.g[a].B--, a = e.listeners.count, a--, a || (b[0].style.msTouchAction = n, this.A(c.d[c.c], b)), 0 === this.l && this.A(c.d[c.b] + " " + c.d[c.a]))
    }
  }, r:function(a, b) {
    b || (b = c.q);
    b.on(a, this.m)
  }, A:function(a, b) {
    b || (b = c.q);
    b.off(a, this.m)
  }, o:function(a) {
    for(var b, d = 0, e = a.changedFingers.length;d < e;d++) {
      b = a.changedFingers[d];
      for(var f = b.firstTarget;f;) {
        var l = $(f), h = c.hasStore(l);
        if(h && h.listeners) {
          for(var k in h.listeners) {
            if(h.listeners.hasOwnProperty(k)) {
              var l = h.listeners[k], m = this.g[k].gesture;
              if(l && (l.length && !b.isGestureDisabled(k)) && (a.fingers = h.fingers.slice(), m = m._process(b, a), b.disableGesture(k, m === p), m === g)) {
                h = this.H(k, a);
                d = 0;
                for(e = l.length;d < e;d++) {
                  l[d].apply(f, [h])
                }
                h.isPropagationStopped() && (f = {});
                break
              }
            }
          }
        }
        f = f.parentNode
      }
    }
  }, H:function(a) {
    return{type:a, v:p, preventDefault:function() {
      this.v = g
    }, isDefaultPrevented:function() {
      return this.v
    }, z:p, stopPropagation:function() {
      this.z = g
    }, isPropagationStopped:function() {
      return this.z
    }}
  }, h:p, m:function(a) {
    if(!a.originalEvent._mantraHandled) {
      a.originalEvent._mantraHandled = g;
      a.preventDefault();
      a = this.J(a);
      var b = a.type, d = a.input;
      this.h && this.h != d || !this.h && b != c.c || (this.M(a), b == c.c ? (this.h = d, this.o(a)) : b == c.b ? this.o(a) : b == c.a && (this.k.length || (this.h = p), this.o(a)))
    }
  }, J:function(a) {
    a.N && (a = a.N);
    a = {originalEvent:a, changedFingers:[]};
    a.type = this.L(a);
    a.input = this.K(a);
    return a
  }, K:function(a) {
    a = a.originalEvent;
    c.e.pointerevents ? a = c["POINTER_" + c.C[a.pointerType]] : (a = a.type, a = 0 == a.indexOf("touch") ? c.F : c.D);
    return a
  }, L:function(a) {
    a = a.originalEvent;
    a = a.type;
    ~c.d[c.c].indexOf(a) ? a = c.c : ~c.d[c.a].indexOf(a) ? a = c.a : ~c.d[c.b].indexOf(a) && (a = c.b);
    return a
  }, k:[], f:{}, M:function(a) {
    var b = a.originalEvent;
    if(c.e.pointerevents) {
      this.p(b.pointerId, a, b)
    }else {
      if(b.changedTouches) {
        for(var d = 0, e = b.changedTouches.length;d < e;d++) {
          var f = b.changedTouches[d];
          this.p(f.identifier, a, f)
        }
      }else {
        this.p(0, a, b)
      }
    }
  }, p:function(a, b, d) {
    var e, f = b.type;
    switch(f) {
      case c.c:
        if(this.f[a]) {
          e = this.f[a]
        }else {
          e = this.f[a] = new c.Finger(d);
          this.k.push(e);
          for(a = e.firstTarget;a;) {
            d = $(a);
            if(d = c.hasStore(d)) {
              d.fingers || (d.fingers = []), d.fingers.push(e)
            }
            a = a.parentNode
          }
        }
        break;
      case c.b:
        e = this.f[a];
        e.update(d, f);
        break;
      case c.a:
        e = this.f[a];
        this.k.splice(this.k.indexOf(e), 1);
        delete this.f[a];
        e.update(d, f);
        for(a = e.firstTarget;a;) {
          d = $(a), (d = c.hasStore(d)) && d.fingers.splice(d.fingers.indexOf(e), 1), a = a.parentNode
        }
    }
    -1 == b.changedFingers.indexOf(e) && b.changedFingers.push(e)
  }, statics:{}});
  c.relayMethod(c, c.GesturesDispatcher, "on");
  c.relayMethod(c, c.GesturesDispatcher, "off");
  c.relayMethod(c, c.GesturesDispatcher, "register");
  c.define("Mantra.Gesture", {singleton:g, "abstract":g, name:n, constructor:function() {
    this.name && c.GesturesDispatcher.register(this)
  }, maxSpeed:n, minSpeed:n, maxDelta:n, minDelta:n, minDelay:n, maxDelay:n, axis:n, fingers:1, _process:function(a, b) {
    this.i = a;
    this.I = b;
    var d;
    switch(a.phase) {
      case c.b:
        var e = this.s();
        e || (d = p);
        break;
      case c.a:
        e = this.s(), d = this.G(), d = e && d
    }
    d !== p && "process" in this && (d = this.process.apply(this, arguments));
    this.i = this.I = n;
    return d
  }, s:function() {
    return this.maxDelta !== n && this.i.deltaTotal > this.maxDelta || this.minDelta !== n && this.i.deltaTotal < this.minDelta ? p : g
  }, G:function() {
    return this.maxDelay !== n && this.i.time > this.maxDelay || this.minDelay !== n && this.i.time < this.minDelay ? p : g
  }, statics:{}});
  c.define("Mantra.Finger", {constructor:function(a) {
    this.phase = "start";
    this.states = [];
    this.t = {};
    this.w(this.u(a));
    this.firstTarget = a.target
  }, identifier:n, clientX:n, clientY:n, pageX:n, pageY:n, screenX:n, screenY:n, target:n, phase:n, firstTarget:n, deltaX:n, deltaY:n, deltaXTotal:n, deltaYTotal:n, speedX:n, speedY:n, timeDelta:n, time:n, states:n, update:function(a, b) {
    this.phase = b;
    this.w(this.u(a))
  }, u:function(a) {
    var b = {};
    a || (a = this);
    b.identifier = "identifier" in a ? a.identifier : a.pointerId || 0;
    b.clientX = a.clientX;
    b.clientY = a.clientY;
    b.pageX = a.pageX;
    b.pageY = a.pageY;
    b.screenX = a.screenX;
    b.screenY = a.screenY;
    b.target = a.target;
    a = this.states.length ? this.states[this.states.length - 1] : n;
    var d = this.states[0];
    b.timestamp = 1 * new Date;
    b.timeDelta = a ? b.timestamp - a.timestamp : 0;
    b.time = a ? b.timestamp - d.timestamp : 0;
    this.phase == c.a ? (b.deltaX = a.deltaX, b.deltaY = a.deltaY, b.speedX = a.speedX, b.speedY = a.speedY) : (b.deltaX = a ? b.clientX - a.clientX : 0, b.deltaY = a ? b.clientY - a.clientY : 0, b.speedX = a ? b.deltaX / b.timeDelta : 0, b.speedY = a ? b.deltaY / b.timeDelta : 0);
    b.deltaXTotal = a ? b.clientX - d.clientX : 0;
    b.deltaYTotal = a ? b.clientY - d.clientY : 0;
    b.delta = Math.sqrt(Math.pow(b.deltaX, 2) + Math.pow(b.deltaY, 2));
    b.deltaTotal = Math.sqrt(Math.pow(b.deltaXTotal, 2) + Math.pow(b.deltaYTotal, 2));
    b.speed = Math.sqrt(Math.pow(b.speedX, 2) + Math.pow(b.speedY, 2));
    return b
  }, w:function(a) {
    this.states.push(a);
    for(var b in a) {
      a.hasOwnProperty(b) && (this[b] = a[b])
    }
  }, disableGesture:function(a, b) {
    this.t[a] = b
  }, isGestureDisabled:function(a) {
    return this.t[a] === g
  }, statics:{}});
  c.define("Mantra.gestures");
  c.define("Mantra.gestures.Tap", {extend:"Mantra.Gesture", name:"tap", maxDelta:10, maxDelay:300, constructor:function() {
    this.j.apply(this)
  }});
  c.define("Mantra.gestures.LongTap", {extend:"Mantra.gestures.Tap", name:"longtap", minDelay:300, maxDelay:1E3, constructor:function() {
    this.j.apply(this)
  }})
}).call(this, window);

